package textExcel;

// Update this file with your own code.

public class Spreadsheet implements Grid
{
	private int rows = 20;
	private int cols = 12;
	//2d array for rows and columns
	Cell [][] arr1 = new EmptyCell[rows][cols];	
	public Spreadsheet () {
			for( int i = 0; i < arr1.length; i++){
				for (int j = 0; j<arr1[i].length; j++){
					arr1[i][j] = new EmptyCell();
				}
			}
		}
	
	
	public String processCommand(String command)
	{	
		
		if(command.equalsIgnoreCase("")){
			return "";
		}
		if (command.indexOf(" ") > 0){
			String[] commandBreakdown = command.split(" ", 3);
			if (commandBreakdown.length > 1){
				if (commandBreakdown[1].equals("=")){
					String location = commandBreakdown[0];
					SpreadsheetLocation cellLocation = new SpreadsheetLocation(location);
					int rowNum = cellLocation.getRow();
					int columnNum = cellLocation.getCol();
					if (commandBreakdown[2].substring(commandBreakdown[2].length()-1).equals("%")){
						arr1[rowNum][columnNum] = new PercentCell(commandBreakdown[2]);
					} else if(commandBreakdown[2].charAt(0) == '"' && commandBreakdown[2].charAt(commandBreakdown[2].length()-1) == '"'){
						arr1[rowNum][columnNum] = new TextCell(commandBreakdown[2].substring(1, commandBreakdown[2].length()-1));
					}else if (commandBreakdown[2].charAt(0) == '(' && commandBreakdown[2].charAt(commandBreakdown[2].length()-1) == ')'){
						arr1[rowNum][columnNum] = new FormulaCell(commandBreakdown[2]);
					} else {
						arr1[rowNum][columnNum] = new ValueCell(commandBreakdown[2]);
					}
					return (getGridText());
				} else if (commandBreakdown[0].equalsIgnoreCase("clear")){
					SpreadsheetLocation cellLocation = new SpreadsheetLocation(commandBreakdown[1]);
					arr1[cellLocation.getRow()][cellLocation.getCol()] = new EmptyCell();
					return (getGridText());
				}
			}
		}else if (command.equalsIgnoreCase("clear")){
			for( int i = 0; i < arr1.length; i++){
				for (int j = 0; j<arr1[i].length; j++){
					arr1[i][j] = new EmptyCell();
				}
			}
			return (getGridText());
		} else if(command.length() < 5){
			SpreadsheetLocation cellLocation = new SpreadsheetLocation(command);
			return (getCell(cellLocation).fullCellText());
		}
		return "";
	}
	
	public int getRows()
	{
		return this.rows;
	}
	public int getCols()
	{
		return this.cols;
	}

	public Cell getCell(Location loc)
	{
		return arr1[loc.getRow()][loc.getCol()];
	}
	
	public String getGridText()
	{
		String grid = "";
		grid += "   |";
		char columnLet = 'A';
		for(int i = 0; i < 12; i++){
			grid += ((char)(columnLet)) + "         |";
			columnLet += 1;
		}
		grid += "\n";
		
		for (int i = 0; i < 20; i++){
			if(i<9){
				grid += (i+1) + "  |";
			} else {
				grid += (i+1) + " |";
			}
			for(int j = 0; j<12 ; j++){
				grid += arr1[i][j].abbreviatedCellText() + "|";
			}
			grid += "\n";
		}
		
		return grid;
	}

}